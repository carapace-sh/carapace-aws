name: check-no-public-access
description: Checks whether a resource policy can grant public access to the specified resource type.
flags:
    --cli-input-json=: Read arguments from the JSON string provided
    --cli-input-yaml=: Read arguments from the YAML string provided
    --generate-cli-skeleton: Prints a JSON skeleton to standard output without sending an API request
    --policy-document=!: The JSON policy document to evaluate for public access.
    --resource-type=!: The type of resource to evaluate for public access.
completion:
    flag:
        resource-type:
            - AWS::DynamoDB::Table
            - AWS::DynamoDB::Stream
            - AWS::EFS::FileSystem
            - AWS::OpenSearchService::Domain
            - AWS::Kinesis::Stream
            - AWS::Kinesis::StreamConsumer
            - AWS::KMS::Key
            - AWS::Lambda::Function
            - AWS::S3::Bucket
            - AWS::S3::AccessPoint
            - AWS::S3Express::DirectoryBucket
            - AWS::S3::Glacier
            - AWS::S3Outposts::Bucket
            - AWS::S3Outposts::AccessPoint
            - AWS::SecretsManager::Secret
            - AWS::SNS::Topic
            - AWS::SQS::Queue
            - AWS::IAM::AssumeRolePolicyDocument
            - AWS::S3Tables::TableBucket
            - AWS::ApiGateway::RestApi
            - AWS::CodeArtifact::Domain
            - AWS::Backup::BackupVault
            - AWS::CloudTrail::Dashboard
            - AWS::CloudTrail::EventDataStore
            - AWS::S3Tables::Table
            - AWS::S3Express::AccessPoint
