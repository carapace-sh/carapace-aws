name: codeguru-security
description: Amazon CodeGuru Security
commands:
    - name: get-account-configuration
      description: Use to get the encryption configuration for an account.
    - name: get-metrics-summary
      description: Returns a summary of metrics for an account from a specified date, including number of open findings, the categories with most findings, the scans with most open findings, and scans with most open critical findings.
      flags:
        --date=!: The date you want to retrieve summary metrics from, rounded to the nearest day.
    - name: get-scan
      description: Returns details about a scan, including whether or not a scan has completed.
      flags:
        --run-id=: UUID that identifies the individual scan run you want to view details about.
        --scan-name=!: The name of the scan you want to view details about.
    - name: list-findings-metrics
      description: Returns metrics about all findings in an account within a specified time range.
      flags:
        --end-date=!: The end date of the interval which you want to retrieve metrics from.
        --max-results=: The maximum number of results to return in the response.
        --next-token=: A token to use for paginating results that are returned in the response.
        --start-date=!: The start date of the interval which you want to retrieve metrics from.
    - name: list-scans
      description: Returns a list of all scans in an account.
      flags:
        --max-results=: The maximum number of results to return in the response.
        --next-token=: A token to use for paginating results that are returned in the response.
    - name: list-tags-for-resource
      description: Returns a list of all tags associated with a scan.
      flags:
        --resource-arn=!: The ARN of the `ScanName` object.
    - name: tag-resource
      description: Use to add one or more tags to an existing scan.
      flags:
        --resource-arn=!: The ARN of the `ScanName` object.
        --tags=!: An array of key-value pairs used to tag an existing scan.
    - name: untag-resource
      description: Use to remove one or more tags from an existing scan.
      flags:
        --resource-arn=!: The ARN of the `ScanName` object.
        --tag-keys=!: A list of keys for each tag you want to remove from a scan.
    - name: batch-get-findings
      description: Returns a list of requested findings from standard scans.
      flags:
        --finding-identifiers=!: A list of finding identifiers.
    - name: create-scan
      description: Use to create a scan using code uploaded to an Amazon S3 bucket.
      flags:
        --analysis-type=: The type of analysis you want CodeGuru Security to perform in the scan, either `Security` or `All`.
        --client-token=: The idempotency token for the request.
        --resource-id=!: The identifier for the resource object to be scanned.
        --scan-name=!: The unique name that CodeGuru Security uses to track revisions across multiple scans of the same resource.
        --scan-type=: The type of scan, either `Standard` or `Express`.
        --tags=: An array of key-value pairs used to tag a scan.
      completion:
        flag:
            analysis-type:
                - Security
                - All
            scan-type:
                - Standard
                - Express
    - name: create-upload-url
      description: Generates a pre-signed URL, request headers used to upload a code resource, and code artifact identifier for the uploaded resource.
      flags:
        --scan-name=!: The name of the scan that will use the uploaded resource.
    - name: get-findings
      description: Returns a list of all findings generated by a particular scan.
      flags:
        --max-results=: The maximum number of results to return in the response.
        --next-token=: A token to use for paginating results that are returned in the response.
        --scan-name=!: The name of the scan you want to retrieve findings from.
        --status=: The status of the findings you want to get.
      completion:
        flag:
            status:
                - Closed
                - Open
                - All
    - name: update-account-configuration
      description: Use to update the encryption configuration for an account.
      flags:
        --encryption-config=!: The customer-managed KMS key ARN you want to use for encryption.
